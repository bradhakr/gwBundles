<l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
    <l7:References>
        <l7:Item>
            <l7:Name>Root Node</l7:Name>
            <l7:Id>0000000000000000ffffffffffffec76</l7:Id>
            <l7:Type>FOLDER</l7:Type>
            <l7:Resource>
                <l7:Folder id="0000000000000000ffffffffffffec76">
                    <l7:Name>Root Node</l7:Name>
                </l7:Folder>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>presales</l7:Name>
            <l7:Id>e5fa8dd4a897fdbdafa8327bde4b4384</l7:Id>
            <l7:Type>FOLDER</l7:Type>
            <l7:Resource>
                <l7:Folder folderId="0000000000000000ffffffffffffec76" id="e5fa8dd4a897fdbdafa8327bde4b4384">
                    <l7:Name>presales</l7:Name>
                </l7:Folder>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>presales/GWINFO</l7:Name>
            <l7:Id>e5fa8dd4a897fdbdafa8327bde4b4381</l7:Id>
            <l7:Type>SERVICE</l7:Type>
            <l7:Resource>
                <l7:Service id="e5fa8dd4a897fdbdafa8327bde4b4381">
                    <l7:ServiceDetail folderId="e5fa8dd4a897fdbdafa8327bde4b4384" id="e5fa8dd4a897fdbdafa8327bde4b4381">
                        <l7:Name>GWINFO</l7:Name>
                        <l7:Enabled>true</l7:Enabled>
                        <l7:ServiceMappings>
                            <l7:HttpMapping>
                                <l7:UrlPattern>/rest/gwInfo</l7:UrlPattern>
                                <l7:Verbs>
                                    <l7:Verb>DELETE</l7:Verb>
                                    <l7:Verb>POST</l7:Verb>
                                    <l7:Verb>GET</l7:Verb>
                                    <l7:Verb>PUT</l7:Verb>
                                </l7:Verbs>
                            </l7:HttpMapping>
                        </l7:ServiceMappings>
                        <l7:Properties>
                            <l7:Property key="wssProcessingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:ServiceDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;wsp:Policy xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy" xmlns:L7p="http://www.layer7tech.com/ws/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="************************************************************"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="API :- &amp;lt;Enter the API Name&amp;gt;"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="API Group :- &amp;lt;Enter the API Group&amp;gt;"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="API TYPE :- &amp;lt;REST/SOAP/DATA&amp;gt;"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="Author: Balaji Radhakrishnan"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;L7p:CommentAssertion&gt;
            &lt;L7p:Comment stringValue="************************************************************"/&gt;
        &lt;/L7p:CommentAssertion&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:SslAssertion/&gt;
                &lt;L7p:HttpBasic/&gt;
                &lt;L7p:Authentication&gt;
                    &lt;L7p:IdentityProviderOid goidValue="0000000000000000fffffffffffffffe"/&gt;
                &lt;/L7p:Authentication&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICAiQ2xpZW50SUQiOiAiJHtyZXF1ZXN0LmNsaWVudGlkfSIKICAgIkdXIjoiJHtnYXRld2F5LmNsdXN0ZXIuaG9zdG5hbWV9IiwKICAiUmVxdWVzdCI6IHsKICAgIlJlbW90ZUlQIjogIiR7cmVxdWVzdC50Y3AucmVtb3RlSVB9IiwKICAgICAiUmVtb3RlQWRkIjogIiR7cmVxdWVzdC50Y3AucmVtb3RlQWRkcmVzc30iLAogICAiUmVtb3RlSG9zdCI6ICIke3JlcXVlc3QudGNwLnJlbW90ZUhvc3R9IiwKICAgIlJlbW90ZVBvcnQiOiAiJHtyZXF1ZXN0LnRjcC5yZW1vdGVQb3J0fSIKICB9LAp9Cg=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                &lt;/L7p:HardcodedResponse&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{ "Error": "Authentication Failure",
   "Description": "USer not found, please contact Admin"
}]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                        &lt;L7p:item nameValuePair="included"&gt;
                            &lt;L7p:Key stringValue="x-ca-err"/&gt;
                            &lt;L7p:Value stringValue="AuthN Failed"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="402"/&gt;
                    &lt;L7p:IncludePolicyDownloadURL booleanValue="true"/&gt;
                &lt;/L7p:CustomizeErrorResponse&gt;
                &lt;L7p:RaiseError/&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Service>
            </l7:Resource>
        </l7:Item>
        <l7:Item>
            <l7:Name>presales/STRING- SPLIT</l7:Name>
            <l7:Id>e5fa8dd4a897fdbdafa8327bde4b4382</l7:Id>
            <l7:Type>SERVICE</l7:Type>
            <l7:Resource>
                <l7:Service id="e5fa8dd4a897fdbdafa8327bde4b4382">
                    <l7:ServiceDetail folderId="e5fa8dd4a897fdbdafa8327bde4b4384" id="e5fa8dd4a897fdbdafa8327bde4b4382">
                        <l7:Name>STRING- SPLIT</l7:Name>
                        <l7:Enabled>true</l7:Enabled>
                        <l7:ServiceMappings>
                            <l7:HttpMapping>
                                <l7:UrlPattern>/rest/strSplit</l7:UrlPattern>
                                <l7:Verbs>
                                    <l7:Verb>DELETE</l7:Verb>
                                    <l7:Verb>POST</l7:Verb>
                                    <l7:Verb>GET</l7:Verb>
                                    <l7:Verb>PUT</l7:Verb>
                                </l7:Verbs>
                            </l7:HttpMapping>
                        </l7:ServiceMappings>
                        <l7:Properties>
                            <l7:Property key="wssProcessingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:ServiceDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy">&lt;wsp:Policy xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy" xmlns:L7p="http://www.layer7tech.com/ws/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ewogICJzdWIiOiAiOWxrczZpbDNSYjdYeG10NVpEYUZRUHQ5Q01IMHVMdTNiY0xmNzh3YjdPayIsCiAgImF1ZCI6ICIzM2FjNThmOC1kZTEyLTQ1NDAtOGZiNy1hMzQ0NjBkZGJmM2QiLAogICJjX2hhc2giOiAiejB6dm0taEI2WGxIcloteDJFSWFUQSIsCiAgImFjciI6ICIwIiwKICAiYXpwIjogIjMzYWM1OGY4LWRlMTItNDU0MC04ZmI3LWEzNDQ2MGRkYmYzZCIsCiAgImF1dGhfdGltZSI6IDE1OTQwNDUyNTYsCiAgImlzcyI6ICJodHRwczovL3NzZ3FhLnNlY3VyaXR5LmJyb2FkY29tLmNvbTo4NDQzIiwKICAiZXhwIjogMTU5NDEzMTY1NiwKICAiaWF0IjogMTU5NDA0NTI1Ngp9"/&gt;
                    &lt;L7p:VariableToSet stringValue="idtoken"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtpZHRva2VufQ=="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="tmp-Idtoken"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="tmp-idtoken"/&gt;
                    &lt;L7p:Regex stringValue="\s\}$"/&gt;
                    &lt;L7p:RegexName stringValue="Extract id_token"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Before change id_token - ${tmp-idtoken.mainpart}"/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="b3BlbmlkIGVtYWlsIHByb2ZpbGUgcGhvbmUgYWRkcmVzcyBsZWlkb3NjbGFpbTAx"/&gt;
                    &lt;L7p:VariableToSet stringValue="grantedScope"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Split&gt;
                    &lt;L7p:IgnoreEmptyValues booleanValue="true"/&gt;
                    &lt;L7p:InputVariable stringValue="grantedScope"/&gt;
                    &lt;L7p:OutputVariable stringValue="scopes"/&gt;
                    &lt;L7p:SplitPattern stringValue=" "/&gt;
                &lt;/L7p:Split&gt;
                &lt;L7p:ForEachLoop L7p:Usage="Required" loopVariable="scopes" variablePrefix="scope"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue="${scope.current}"/&gt;
                                &lt;L7p:Expression2 stringValue="leidosclaim01"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item binary="included"&gt;
                                        &lt;L7p:RightValue stringValue="leidosclaim01"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHt0bXAtaWR0b2tlbi5tYWlucGFydH0sICJBZGRpdGlvbmFsQ2xhaW0wMSI6ICJuZXdDbGFpbS0wMSI="/&gt;
                                &lt;L7p:VariableToSet stringValue="tmp-idtoken.mainpart"/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue="${scope.current}"/&gt;
                                &lt;L7p:Expression2 stringValue="leidosclaim02"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item binary="included"&gt;
                                        &lt;L7p:RightValue stringValue="leidosclaim02"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHt0bXAtaWR0b2tlbi5tYWlucGFydH0gLCAiQWRkaXRpb25hbENsYWltMDIiOiAibmV3Q2xhaW0tMDIi"/&gt;
                                &lt;L7p:VariableToSet stringValue="tmp-idtoken.mainpart"/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:ComparisonAssertion&gt;
                                &lt;L7p:Expression1 stringValue="${scope.current}"/&gt;
                                &lt;L7p:Expression2 stringValue="leidosclaim03"/&gt;
                                &lt;L7p:Predicates predicates="included"&gt;
                                    &lt;L7p:item binary="included"&gt;
                                        &lt;L7p:RightValue stringValue="leidosclaim03"/&gt;
                                    &lt;/L7p:item&gt;
                                &lt;/L7p:Predicates&gt;
                            &lt;/L7p:ComparisonAssertion&gt;
                            &lt;L7p:SetVariable&gt;
                                &lt;L7p:Base64Expression stringValue="JHt0bXAtaWR0b2tlbi5tYWlucGFydH0gLCAiQWRkaXRpb25hbENsYWltMDMiOiAibmV3Q2xhaW0tMDMi"/&gt;
                                &lt;L7p:VariableToSet stringValue="tmp-idtoken.mainpart"/&gt;
                            &lt;/L7p:SetVariable&gt;
                        &lt;/wsp:All&gt;
                        &lt;wsp:All wsp:Usage="Required"&gt;
                            &lt;L7p:TrueAssertion/&gt;
                        &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                &lt;/L7p:ForEachLoop&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0bXAtaWR0b2tlbi5tYWlucGFydH0KfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="Idtoken"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;wsp:All L7p:Enabled="false" wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                        &lt;L7p:Expression1 stringValue="${request.shared.scope.results[0]}"/&gt;
                        &lt;L7p:Expression2 stringValue="leidosclaim01"/&gt;
                        &lt;L7p:Operator operator="CONTAINS"/&gt;
                        &lt;L7p:Predicates predicates="included"&gt;
                            &lt;L7p:item binary="included"&gt;
                                &lt;L7p:Operator operator="CONTAINS"/&gt;
                                &lt;L7p:RightValue stringValue="leidosclaim01"/&gt;
                            &lt;/L7p:item&gt;
                        &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                        &lt;L7p:Base64Expression stringValue="JHt0bXAtaWR0b2tlbi5tYWlucGFydH0sCiJBZGRpdGlvbmFsQ2xhaW0wMSI6ICJuZXdDbGFpbS0wMSIKfQ=="/&gt;
                        &lt;L7p:VariableToSet stringValue="Idtoken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                        &lt;L7p:Detail stringValue="After change id_token - ${idtoken}"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                &lt;/wsp:All&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Nothing Changed id_token: ${idtoken.minpart}"/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:TrueAssertion/&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:HardcodedResponse&gt;
            &lt;L7p:Base64ResponseBody stringValue="JHtpZHRva2VufQ=="/&gt;
        &lt;/L7p:HardcodedResponse&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Service>
            </l7:Resource>
        </l7:Item>
    </l7:References>
    <l7:Mappings>
        <l7:Mapping action="NewOrExisting" srcId="0000000000000000ffffffffffffec76" type="FOLDER"/>
        <l7:Mapping action="NewOrExisting" srcId="e5fa8dd4a897fdbdafa8327bde4b4384" type="FOLDER">
            <l7:Properties>
                <l7:Property key="MapBy">
                    <l7:StringValue>path</l7:StringValue>
                </l7:Property>
                <l7:Property key="MapTo">
                    <l7:StringValue>presales</l7:StringValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="e5fa8dd4a897fdbdafa8327bde4b4381" type="SERVICE">
            <l7:Properties>
                <l7:Property key="MapBy">
                    <l7:StringValue>path</l7:StringValue>
                </l7:Property>
                <l7:Property key="MapTo">
                    <l7:StringValue>presales/GWINFO</l7:StringValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="e5fa8dd4a897fdbdafa8327bde4b4382" type="SERVICE">
            <l7:Properties>
                <l7:Property key="MapBy">
                    <l7:StringValue>path</l7:StringValue>
                </l7:Property>
                <l7:Property key="MapTo">
                    <l7:StringValue>presales/STRING- SPLIT</l7:StringValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
    </l7:Mappings>
</l7:Bundle>
